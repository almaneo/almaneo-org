# AlmaChat V0.4 - Light Theme & UI Cleanup & App Guide

> Session 105 (2026-02-18) 수립

## Overview

V0.4는 **UI 개선** 중심:
1. **Light Theme** 추가 (따뜻한 크림 톤) + 설정에서 Dark/Light 전환
2. **UI Cleanup** — 테마 색상 조화, 불필요한 색상 제거, 아이콘폰트/텍스트 버튼 활용
3. **App Guide** — 초기 사용자용 온보딩 가이드 (앱스토어 등록용)

> "배경색이 어둡다 보니, 따뜻한 느낌보다는 차가운 느낌이 강하다"
> → Light Theme로 "Cold Code, **Warm Soul**" 철학의 Warm 면을 강조

---

## Phase A: Theme Infrastructure (신규 1파일, 수정 2파일)

### A1. `AlmaColors` ThemeExtension (`theme.dart` 확장)

시맨틱 색상 토큰으로 Dark/Light 양쪽 값 정의:

```dart
class AlmaColors extends ThemeExtension<AlmaColors> {
  // Scaffold & Surface
  final Color scaffold;        // Dark: #0A0F1A, Light: #F5F0EB (warm cream)
  final Color surface;         // Dark: #1E293B, Light: #FFFFFF
  final Color surfaceVariant;  // Dark: #2D3748, Light: #F0EBE5

  // Text
  final Color textPrimary;     // Dark: white, Light: #1A1A2E
  final Color textSecondary;   // Dark: white70, Light: #4A4A5A
  final Color textTertiary;    // Dark: white38, Light: #8A8A9A

  // Card & Container
  final Color cardBg;          // Dark: slateGray, Light: white
  final Color cardBorder;      // Dark: transparent, Light: #E8E0D8

  // Input
  final Color inputBg;         // Dark: #0F1724, Light: #F5F0EB
  final Color inputBorder;     // Dark: white12, Light: #D4C4B0

  // Divider & Border
  final Color divider;         // Dark: white12, Light: #E8E0D8
  final Color borderDefault;   // Dark: white10, Light: #D4C4B0

  // Status bar overlay, bottom nav
  final Color navBg;           // Dark: #0A0F1A, Light: #FFFFFF
  final Color navBorder;       // Dark: white10, Light: #E8E0D8

  // Badge & Chip
  final Color chipBg;          // Dark: white10, Light: #F0EBE5
  final Color chipSelectedBg;  // Dark: electricBlue15, Light: electricBlue10

  // Shadow (light mode only)
  final List<BoxShadow> cardShadow;  // Dark: none, Light: soft shadow

  // lerp, copyWith, etc.
}
```

브랜드 색상(`electricBlue`, `terracottaOrange`, `cyan`, `sandGold` 등)은 양쪽 테마 공통으로 `AlmaTheme` static에 유지.

### A2. `ThemeProvider` 생성 (`providers/theme_provider.dart` 신규)

`LanguageProvider` 패턴 따라:
```dart
enum ThemePreference { system, light, dark }

class ThemeState {
  final ThemePreference preference;
  final Brightness resolved;  // 실제 적용 brightness
}

class ThemeNotifier extends StateNotifier<ThemeState> {
  // SharedPreferences 키: 'theme_preference'
  // setTheme(ThemePreference)
  // _resolveSystemBrightness() via SchedulerBinding
}
```

### A3. `theme.dart` 수정

- `AlmaTheme.theme(AlmaColors colors)` 팩토리: `ThemeData` 생성
- `AlmaTheme.darkColors` / `AlmaTheme.lightColors` static 상수
- `AlmaTheme.streamTheme(BuildContext context, Brightness brightness)` — Dark/Light 분기
- `extension AlmaColorsX on BuildContext { AlmaColors get alma => ... }`
- 기존 `darkTheme` getter → `theme(colors)` 팩토리로 대체
- 기존 `glassCard()` → `themedCard(context)` 로 대체 (Light: white + shadow, Dark: glass)

### A4. `main.dart` 수정

- `ref.watch(themeProvider)` → `AlmaTheme.theme(colors)` 연동
- `_MainShell` 하단 네비 색상 → `context.alma.navBg`, `context.alma.navBorder` 등
- Stream Chat 테마도 brightness 연동
- `_buildSplash()` 색상 → 테마 대응

---

## Phase B: High-Impact Screen Migration (6파일)

가장 사용 빈도 높은 화면부터:

| 파일 | 예상 변경 수 | 핵심 변경 |
|------|:-----------:|----------|
| `channel_list_screen.dart` | ~80 | 채널 타일 bg, 검색바, 바텀시트 |
| `chat_screen.dart` | ~30 | AppBar, 입력창, 초대 바텀시트 |
| `home_screen.dart` | ~40 | 필터 칩, 밋업 카드, 생성 모달 |
| `profile_screen.dart` | ~70 | 정보 타일, 버튼, 배경 |
| `settings_screen.dart` | ~40 | **테마 토글 UI 추가** + 색상 마이그레이션 |
| `login_screen.dart` | ~25 | 배경 그라디언트, 버튼, 슬라이드 카드 |

**마이그레이션 패턴:**
```dart
// Before:
Container(color: AlmaTheme.slateGray)
Text(style: TextStyle(color: Colors.white))
Text(style: TextStyle(color: Colors.white.withValues(alpha: 0.5)))

// After:
Container(color: context.alma.cardBg)
Text(style: TextStyle(color: context.alma.textPrimary))
Text(style: TextStyle(color: context.alma.textSecondary))
```

**settings_screen.dart 테마 토글:**
- Notifications 섹션 아래에 "테마" 섹션 추가
- 3개 옵션: 시스템 / 라이트 / 다크 (SegmentedButton 또는 RadioListTile)
- 15개 언어 번역 키 추가 (`settings.theme`, `settings.themeSystem`, `settings.themeLight`, `settings.themeDark`)

---

## Phase C: Remaining Screen Migration (5파일)

| 파일 | 예상 변경 수 |
|------|:-----------:|
| `meetup_detail_screen.dart` | ~50 |
| `meetup_chat_screen.dart` | ~15 |
| `create_channel_screen.dart` | ~20 |
| `browse_channels_screen.dart` | ~25 |
| `find_friends_screen.dart` | ~20 |

---

## Phase D: Widget Migration (8파일)

| 파일 | 예상 변경 수 | 비고 |
|------|:-----------:|------|
| `translated_message.dart` | ~50 | my-msg: electricBlue 유지, other-msg: cardBg |
| `chat_widgets.dart` | ~10 | |
| `recording_indicator.dart` | ~5 | |
| `kindness_score_card.dart` | ~15 | |
| `ambassador_badge.dart` | ~10 | |
| `wallet_info_card.dart` | ~10 | |
| `alma_logo.dart` | ~3 | |
| `fullscreen_image.dart` | ~5 | |

---

## Phase E: App Guide / Onboarding Redesign

### E1. 온보딩 슬라이드 확장 (3 → 6 슬라이드)

| # | 제목 | 아이콘 | 설명 |
|---|------|--------|------|
| 1 | Welcome to AlmaChat | alma_logo | 친절한 사람들의 글로벌 메신저 |
| 2 | Real-Time Translation | translate | 15개 언어 자동 번역, 각자 모국어로 대화 |
| 3 | Create & Join Groups | group_add | 관심사/지역별 채널 생성, 초대 코드로 참여 |
| 4 | Meetup Together | event | 오프라인 밋업 생성, 녹음, 채팅 |
| 5 | Kindness Score | favorite | 밋업/활동으로 Kindness 점수 획득 |
| 6 | Get Started | rocket_launch | 지금 시작하기 (로그인 버튼) |

### E2. 첫 실행 플래그

```dart
// SharedPreferences 키: 'onboarding_completed'
// login_screen.dart에서 체크:
//   - 첫 실행: 온보딩 슬라이드 표시
//   - 이후: 바로 로그인 화면
```

### E3. 설정에서 다시 보기

`settings_screen.dart`에 "앱 가이드 다시 보기" 항목 추가 → 온보딩 슬라이드 재표시

### E4. 15개 언어 번역

각 슬라이드 제목/설명/버튼 번역 키 추가 (약 30개 키 × 15개 언어 = 450항목)

---

## Light Theme 색상 디자인

```
Scaffold Background:  #F5F0EB (Warm Cream)
Card Background:      #FFFFFF (White + soft shadow)
Surface Variant:      #F0EBE5 (Light Beige)
Text Primary:         #1A1A2E (Dark Navy Tone)
Text Secondary:       #4A4A5A (Medium Gray-Blue)
Text Tertiary:        #8A8A9A (Light Gray)
Card Border:          #E8E0D8 (Warm Gray)
Input Background:     #F5F0EB (Cream)
Input Border:         #D4C4B0 (Sand)
Divider:              #E8E0D8 (Warm Gray)
Nav Background:       #FFFFFF
Nav Border:           #E8E0D8

Brand Colors (양쪽 공통):
  Electric Blue:      #0052FF
  Terracotta Orange:  #FF6B00
  Cyan:               #06B6D4
  Sand Gold:          #D4A574
```

> 라이트 테마는 **따뜻한 크림/베이지 톤**으로 "Warm Soul" 강조.
> 순백(#FFFFFF)은 카드에만 사용, 배경은 크림으로.

---

## 색상 변경 참고 (현재 코드 감사 결과)

### 현재 하드코딩된 색상 분포
- `AlmaTheme.*` 참조: **302회** (21파일)
- `Colors.white` 참조: **313회** (21파일)
- `Colors.white.withValues(alpha: X)` 패턴: **~200회**
- `Color(0xFF...)` 직접 사용: **~30회**

### 주요 대상 파일 (변경량 순)
1. `channel_list_screen.dart` — ~80 변경
2. `profile_screen.dart` — ~70 변경
3. `translated_message.dart` — ~50 변경
4. `meetup_detail_screen.dart` — ~50 변경
5. `home_screen.dart` — ~40 변경
6. `settings_screen.dart` — ~40 변경
7. `chat_screen.dart` — ~30 변경
8. `login_screen.dart` — ~25 변경

### 나머지 파일 (변경량 적음)
9. `browse_channels_screen.dart` — ~25
10. `create_channel_screen.dart` — ~20
11. `find_friends_screen.dart` — ~20
12. `meetup_chat_screen.dart` — ~15
13. `kindness_score_card.dart` — ~15
14. `chat_widgets.dart` — ~10
15. `ambassador_badge.dart` — ~10
16. `wallet_info_card.dart` — ~10
17. `recording_indicator.dart` — ~5
18. `alma_logo.dart` — ~3
19. `fullscreen_image.dart` — ~5

---

## 작업 순서 & 예상 규모

| Phase | 내용 | 파일 수 | 예상 변경 라인 |
|:-----:|------|:------:|:------------:|
| A | Theme Infrastructure | 3 | ~300 |
| B | High-Impact Screens | 6 | ~600 |
| C | Remaining Screens | 5 | ~250 |
| D | Widget Migration | 8 | ~200 |
| E | App Guide / Onboarding | 3 | ~400 |
| **합계** | | **~21+** | **~1,750** |

Phase A → B 먼저 완료하면 앱의 핵심 화면이 테마 전환 가능.
Phase C-D는 나머지 화면/위젯 마이그레이션.
Phase E는 독립적이므로 병렬 진행 가능.

---

## 예상 일정

| Phase | 예상 세션 |
|:-----:|:---------:|
| A | 1 세션 |
| B | 2~3 세션 |
| C | 1~2 세션 |
| D | 1 세션 |
| E | 1~2 세션 |
| **합계** | **6~9 세션** |
