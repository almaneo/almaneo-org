# AlmaChat V0.3 - Kindness AI & Stability Plan

> Session 97 (2026-02-17) 수립
> Session 105 (2026-02-18) 완료 정리

## Overview

V0.3은 **안정성 강화** + **Kindness AI MVP** 두 축으로 진행.
V0.2에서 구현한 소셜 기능 위에 AI 기반 밋업 리포트 자동 생성 시스템을 MVP로 구축.

---

## V0.2 잔여 작업 (V0.3에서 마무리)

| V0.2 Step | 상태 | V0.3 조치 |
|-----------|------|-----------|
| Step 4: 초대 링크 | ✅ Session 101 | 백엔드 API + 인앱 참여 (딥링크는 Phase 5) |

---

## V0.3 구현 계획 (5 Phases)

### Phase 1: 안정성 강화 ✅ (Session 97 완료)

1. **Stream Chat 401 재연결 근본 수정** ✅
   - `connectUser` → `connectUserWithProvider` 전환
   - SDK 내부 자동 토큰 갱신 활성화
   - `wsConnectionStatusStream` 감시 → 전체 재연결 폴백
   - 서버 토큰에 24시간 만료 추가

2. **온보딩 반응형 레이아웃** ✅
   - `MediaQuery` 기반 compact 모드 (screenH < 700dp)
   - 로고/폰트/슬라이드 동적 크기 조절

---

### Phase 2: 초대 링크 시스템 ✅ (Session 101 완료)

1. **Supabase 마이그레이션**: `invite_links` 테이블 ✅
2. **백엔드 API** ✅
   - `chat/api/create-invite.ts`: 6자리 코드 생성, 7일 만료, 기존 코드 재사용
   - `chat/api/join-invite.ts`: 코드 검증 → `channel.addMembers()`
3. **Flutter 클라이언트** ✅
   - `chat_screen.dart`: API 기반 초대 코드 생성 + 공유 바텀시트
   - `channel_list_screen.dart`: "코드로 참여" 다이얼로그 (6자리 입력)
4. **15개 언어 번역** ✅ (150 entries)
5. **미완료**: 딥링크 핸들러 (향후 Phase 5)

---

### Phase 3: 밋업 녹음 & 데이터 수집 ✅ (Session 102~103 완료)

**완료된 항목:**

1. **음성 녹음 기능** ✅
   - `record` 패키지 (Flutter audio recorder)
   - 밋업 상세 → "밋업 기록 시작" 버튼 (호스트 전용)
   - 백그라운드 녹음 지원
   - 녹음 파일 → Supabase Storage 업로드
   - 최대 2시간, AAC 포맷

2. **밋업 라이프사이클 UI** ✅
   ```
   [예정] → [진행 중 (녹음)] → [종료] → [완료]
   ```

3. **밋업 그룹 채팅 자동 생성** ✅ (계획 외 추가)
   - 밋업 생성 시 Stream Chat 채널 자동 생성
   - 참가/탈퇴 시 채널 멤버 연동
   - `meetup_chat_screen.dart` 전용 채팅 UI

**미완료 (V0.5+로 연기):**
- 채팅방 사진/영상 → 밋업 미디어로 자동 태깅
- 밋업 종료 시 수집 데이터 패키지화

---

### Phase 4: Kindness AI 분석 엔진 (MVP) → ❌ V0.5+로 연기

사용자 결정에 따라 차후 버전으로 연기.

---

### Phase 5: 폴리싱 & 확장 (향후)

- 이미지 분석 (Gemini Vision): 활동 분류, 인원 카운트
- 영상 하이라이트 자동 편집
- 음성/영상 통화 (Stream Video SDK)
- 스토리/피드 기능
- Kindness 리더보드 인앱
- Ambassador SBT 자동 티어 승급 알림
- Play Store 배포 준비
- 딥링크 핸들러 (`almachat://invite/{code}`)

---

## V0.3 추가 완료 작업 (계획 외)

| 세션 | 작업 | 비고 |
|------|------|------|
| Session 98 | Android 뒤로가기 방지, Web3Auth 로그인 전환 수정 | 안정성 |
| Session 98-100 | 프로필 이미지 영속 시스템 (Supabase DB 기반) | 근본 수정 |
| Session 103 | 밋업 그룹 채팅 자동 생성 | 기능 추가 |
| Session 104 | 코드 리뷰 10개 버그 수정, 배포 | 안정성 |
| Session 105 | 밋업 채팅 버튼 fallback 수정, 8개 밋업 기능 개선 | 기능/안정성 |

---

## 기술 스택 (V0.3 신규)

| 컴포넌트 | 기술 | 용도 |
|----------|------|------|
| 음성 녹음 | `record` Flutter 패키지 | 인앱 녹음 |
| 파일 저장 | Supabase Storage | 음성/사진 파일 |
| 서버 처리 | Vercel Serverless | API 엔드포인트 |
| 프로필 DB | Supabase `chat_profiles` | 프로필 이미지 영속 |

---

## 실제 일정

| Phase | 내용 | 실제 세션 |
|:-----:|------|:---------:|
| 1 | 안정성 강화 | ✅ Session 97 |
| 2 | 초대 링크 | ✅ Session 101 |
| 3 | 녹음 & 데이터 수집 | ✅ Session 102~103 |
| 추가 | 프로필/안정성/밋업 개선 | ✅ Session 98~100, 104~105 |
| 4 | Kindness AI MVP | ❌ V0.5+로 연기 |
| 5 | 폴리싱 & 확장 | 지속적 |

**V0.3 완료: Session 105 (2026-02-18)**
**다음: V0.4 (Light Theme + UI Cleanup + App Guide)**
